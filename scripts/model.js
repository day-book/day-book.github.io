Notes=Backbone.Model.extend({initialize:function(){this.storage=new Storage(this),this.set("zoomLevel",1),this.scopeStartDate=moment().subtract(45,"days"),this.scopeEndDate=this.scopeStartDate.clone().add(90,"days")},setScopeBasedOnZoomLevel:function(){var t=this.get("zoomLevel"),e=this.scopeStartDate.clone().add(this.scopeEndDate.diff(this.scopeStartDate,"days")/2,"days");this.scopeStartDate=e.clone().subtract(45*t,"days"),this.scopeEndDate=e.clone().add(45*t,"days")},getDateRangeInScope:function(){return[this.scopeStartDate.toDate(),this.scopeEndDate.toDate()]},adjustDatesInScope:function(t){this.scopeStartDate.add(t,"days"),this.scopeEndDate.add(t,"days")},getDateTicksInScope:function(){for(var t=[],e=this.scopeStartDate.clone().startOf("day");e.isBefore(this.scopeEndDate);)t.push(e.clone().toDate()),e.add(1,"days");return t},getMonthsInScope:function(){for(var t=this.scopeStartDate.clone().startOf("month"),e=[];t.isBefore(this.scopeEndDate);)e.push([t.clone().toDate(),t.clone().endOf("month").endOf("day").toDate()]),t.add(1,"month");return e},getNoteTypes:function(){return _.sortBy(_.uniq(_.map(this.get("events"),function(t){return t.type})))},getNotesInScope:function(){var t=this;return _.filter(this.get("events"),function(e){var o=moment(e.date);return o.isAfter(t.scopeStartDate)&&o.isBefore(t.scopeEndDate)})},deleteNote:function(t){this.storage.deleteEvent(t,this.get("events"))},addNote:function(t,e,o){var s=e.toLowerCase().trim(),a={id:t.hashCode(),content:t,type:s,date:o.toDate()};this.storage.createEvent(a)},zoom:function(t){var e=this.get("zoomLevel");t&&e>1?(this.set("zoomLevel",e-1),this.setScopeBasedOnZoomLevel(),this.trigger("change:scope")):!t&&3>e&&(this.set("zoomLevel",e+1),this.setScopeBasedOnZoomLevel(),this.trigger("change:scope"))},getUserName:function(t){return this.storage.getUserName(t)}});